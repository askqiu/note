
# 常见WEB类告警分析
查看告警详情，查看请求头、请求体内容，定位到触发告警攻击动作的payload，分析攻击动作是什么，读取文件、打印输出内容、写入文件和尝试下载文件、执行函数或命令等，然后分析告警响应头、响应体、网络行为是否有动作预期的结果，如符合预期则攻击成功。


# 如何判断是否为攻击：
1、通过设备告警、流量特征去查看请求包中是否存在相应的攻击特征，返回包是否有相应的结果
2、以ip为索引，用微步查看是否为攻击ip
3、查看攻击方向，内对内，内对外，外对内，内对内误报率较大，最好上机排查
4、用流量复现，手动验证，即使验证失败，也不能研判为失败，要结合攻击的频率（已经告警了上千上万次，那就要着重注意了）
5、结合资产分析，比如我只开启63389端口，但是你访问了88，99


# webshell告警

监控：Webshell类告警单独设规则，设备上不一定显示攻击成功，可能显示尝试，但这并不代表它没有攻击成功，而要去看流量上下文，看命令执行和响应体，看是否持续访问固定webshell路径即关注频率

# 研判思路：
1、一般进行研判的思路，就是通过流量上下文（看命令执行和响应体）+手工验证+攻击频率次数来判断是否漏洞是否存在，是否攻击成功。

2、可以判断访问webshell进行命令执行，可以判断攻击成功且上传了webshell

3、告警如redis未授权，mongodb未授权等未授权漏洞攻击成功在流量上下文中不能体现，需要去手动验证
但是即使你无法验证成功，也不能就研判为误报，而要结合攻击成功告警的频率（比如说它已经告警成功了20000+），很有可能由于网络拓扑的复杂，在你当前所处的环境中无法验证成功，此时可以让其他不同的网络环境中同事帮忙验证。

# 对于web告警为真实攻击，如何处理

对于 Web 漏洞，首先查看 web 日志，检查是否有上传 webshell 的记录，然后查看后门是否执行了恶意命令或上传了恶意文件（如.exe）。

可以将可疑文件上传到微步社区平台进行分析，对于 webshell 可使用安全工具如 d盾、河马进行查杀。
 VIDAR{f12_1s'^very$useful}
VIDAR{f12_1s'^very$useful}
# 访问排查思路
当 JSP 网页遭受攻击时，可能会表现出各种异常现象和行为。以下是常见的排查步骤和可能的攻击迹象：

### 1. **日志分析**
   - **Web 服务器日志**：检查 Web 服务器（如 Apache、Tomcat）的访问日志和错误日志。查找异常的请求模式，如大量重复的请求、异常的 User-Agent、从未见过的 IP 地址或请求特定文件（如 `.jsp` 文件）的次数增加。
   - **应用日志**：查看应用日志，查找异常的错误或警告信息，尤其是与 JSP 页面相关的错误堆栈跟踪。
   - **数据库日志**：检查是否有可疑的 SQL 查询或数据库异常操作。攻击者可能会通过 SQL 注入进行数据库操作。

### 2. **文件系统检查**
   - **文件篡改**：检查 `.jsp` 文件是否被篡改或增加了未授权的代码。通过对比文件的哈希值（如 MD5、SHA256）或检查文件的 `mtime`（修改时间）来确定文件是否被更改。
   - **新增文件**：检查目录中是否存在不应该存在的文件，如新的 `.jsp` 文件或其他可执行脚本文件（如 `.exe`、`.php` 文件等）。
   - **隐藏文件**：搜索是否有隐藏文件或文件名与原有文件非常相似的伪造文件。

### 3. **网络流量监控**
   - **异常流量**：监控服务器的网络流量，观察是否有异常的出入流量，特别是向不常访问的外部 IP 地址发送数据的情况。
   - **长连接或大量连接**：检查是否有长时间保持的连接或大量异常的连接数，这可能是 DDoS 攻击或其他试图占用系统资源的攻击手段。

### 4. **系统资源使用**
   - **CPU 和内存使用情况**：查看服务器 CPU 和内存的使用情况，如果出现异常高的资源消耗，可能是由于恶意代码的执行或恶意用户的频繁访问。
   - **进程监控**：查看服务器上的进程列表，是否存在异常进程或不应存在的进程。

### 5. **访问控制与权限检查**
   - **用户权限**：检查 Web 应用和数据库用户的权限是否被提升，查看是否有未授权用户对系统文件或数据库进行了操作。
   - **文件权限**：检查关键文件和目录的权限设置，确保没有过多的权限暴露给用户或攻击者。

### 6. **后门与恶意代码**
   - **后门程序**：检查是否存在潜在的后门程序。攻击者可能会在服务器上植入后门，通过这些后门获得持续访问的能力。
   - **恶意代码**：查看 JSP 文件中是否有恶意代码注入，如脚本注入（JavaScript）、命令执行（shell 命令）等。

### 7. **SQL 注入检测**
   - **异常 SQL 查询**：检查数据库中的异常查询记录，可能是攻击者通过 SQL 注入的方式进行数据库操作。
   - **输入验证**：回顾 JSP 页面对用户输入的处理方式，确保所有输入都经过了正确的验证和过滤。

### 8. **XSS 攻击排查**
   - **异常页面行为**：如果页面表现出异常行为（如弹出窗口、页面内容被篡改），可能是 XSS 攻击的迹象。检查用户输入是否被安全输出，是否有未经过滤的 HTML 输出。

### 9. **安全扫描**
   - **漏洞扫描工具**：使用安全扫描工具（如 Burp Suite、OWASP ZAP）扫描应用程序，检查是否存在已知漏洞。
   - **代码审计**：手动或使用工具对 JSP 代码进行安全审计，查找潜在的漏洞如代码注入、SQL 注入、XSS 等。

### 10. **数据库检查**
   - **数据篡改**：检查数据库中的关键数据是否被篡改。
   - **异常用户操作**：查看是否有异常的用户操作记录，如用户权限的突然提升，或者大量数据的删除、修改操作。

### 可能的攻击迹象：
- **页面篡改**：页面内容被修改，可能包含恶意脚本或链接。
- **重定向行为**：页面被重定向到不安全的第三方网站。
- **敏感信息泄露**：页面或网络流量中出现了数据库错误信息、系统路径等敏感信息。
- **异常登录活动**：出现了大量失败的登录尝试或未知用户成功登录的记录。
- **不明的外部连接**：服务器向外部 IP 地址发送数据或进行反向连接。

### 应急响应步骤：
1. **隔离**：如果怀疑服务器被入侵，立即将其从网络隔离，防止进一步的损害。
2. **备份**：对当前系统和日志文件进行备份，确保不丢失关键的取证数据。
3. **分析**：通过日志和文件分析确定攻击途径，并修复相关漏洞。
4. **修复**：删除恶意文件和代码，更新安全补丁，强化访问控制。
5. **监控**：修复后持续监控服务器状态，防止再次遭受攻击。

这些步骤和现象可以帮助你排查和应对 JSP 网页遭受的攻击，同时提高整体的安全性。